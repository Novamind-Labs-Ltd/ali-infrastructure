# -----------------------------------------------------------------------------
# ArgoCD Values - Prod Environment
# -----------------------------------------------------------------------------
# Production-grade configuration with HA.
# Reference: https://github.com/argoproj/argo-helm/tree/main/charts/argo-cd
# -----------------------------------------------------------------------------

# Global settings
global:
  logging:
    level: info

# HA mode
controller:
  replicas: 2
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi

  # Pod disruption budget
  pdb:
    enabled: true
    minAvailable: 1

# Server
server:
  replicas: 2
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  pdb:
    enabled: true
    minAvailable: 1

  # Service type
  service:
    type: ClusterIP

  # Ingress - configure if using ingress controller
  # ingress:
  #   enabled: true
  #   ingressClassName: nginx
  #   hosts:
  #     - argocd.prod.example.com
  #   tls:
  #     - secretName: argocd-tls
  #       hosts:
  #         - argocd.prod.example.com

# Repo Server
repoServer:
  replicas: 2
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  pdb:
    enabled: true
    minAvailable: 1

# Redis HA
redis-ha:
  enabled: true
  replicas: 3
  haproxy:
    enabled: true

# Disable single redis when using HA
redis:
  enabled: false

# Dex for SSO - enable and configure for production
dex:
  enabled: false  # Enable when SSO is configured

# Notifications
notifications:
  enabled: true  # Enable for prod alerts

# ApplicationSet controller
applicationSet:
  enabled: true
  replicas: 2

# Configs
configs:
  # Repository credentials
  # repositories:
  #   - url: https://github.com/your-org/your-repo.git
  #     type: git

  # RBAC policies
  rbac:
    policy.default: role:readonly
    policy.csv: |
      p, role:admin, applications, *, */*, allow
      p, role:admin, clusters, *, *, allow
      p, role:admin, repositories, *, *, allow
      g, admin, role:admin
